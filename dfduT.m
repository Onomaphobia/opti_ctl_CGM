function [dfduT] = dfduT(L1,L2,L3,theta1,theta2,theta3,Xdot,Ydot,u1,u2,u3)

dfduT = [ (cos(theta3 + 2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^3 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)^3 - abs(L1)^2*abs(L2)^2*conj(L3)^3*cos(theta2) + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L3)^3 + abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3)*cos(theta2) - abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) - abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2 + theta3 - conj(theta3)) + abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2*cos(2*real(theta2) - conj(theta2) + conj(theta3)) - cos(theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3) + cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 + 2*cos(2*real(theta2) + 2*real(theta3) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - 2*cos(theta2 + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta2 - conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + 2*cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + cos(conj(theta2) - 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 - 2*cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - cos(2*real(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) + cos(theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2))),                                                                                                                      -(cos(theta3 + 2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^3 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)^3 - abs(L1)^2*abs(L2)^2*conj(L3)^3*cos(theta2) + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L3)^3 + abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3)*cos(theta2) + abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) - abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2 + theta3 - conj(theta3)) + abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2*cos(2*real(theta2) - conj(theta2) + conj(theta3)) - cos(theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3) - cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 + cos(conj(theta2) - theta3 + conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3) + cos(2*real(theta2) + 2*real(theta3) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta2 + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta2 - conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + cos(conj(theta2) - 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*cos(2*real(theta3) + conj(theta2)) - cos(2*real(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) + cos(theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2))),                                                                                                                                                                                                                                                                                                                                                -(cos(theta3 + 2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^3 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)^3 + abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - 2*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) - abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2 + theta3 - conj(theta3)) + cos(theta3 + conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L2) + 2*cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 - cos(conj(theta2) - theta3 + conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3) + cos(2*real(theta2) + 2*real(theta3) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta2 + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta3 - conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L2) + cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*cos(2*real(theta3) + conj(theta2)))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2)));
          (cos(theta3 + 2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^3 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)^3 - abs(L1)^2*abs(L2)^2*conj(L3)^3*cos(theta2) + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L3)^3 + abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3)*cos(theta2) - abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) - 2*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2 + theta3 - conj(theta3)) + abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2*cos(2*real(theta2) - conj(theta2) + conj(theta3)) - cos(theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3) + cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 + 2*cos(2*real(theta2) + 2*real(theta3) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta2 + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta2 - conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + 2*cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + cos(conj(theta2) - 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 - 2*cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) - cos(theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2))), -(cos(theta3 + 2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^3 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)^3 - abs(L1)^2*abs(L2)^2*conj(L3)^3*cos(theta2) + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L3)^3 + abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3)*cos(theta2) + abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) - 2*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2 + theta3 - conj(theta3)) + abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2*cos(2*real(theta2) - conj(theta2) + conj(theta3)) - cos(theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L2)^2*conj(L3) - cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 - cos(conj(theta2) - theta3 + conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3) + cos(2*real(theta2) + 2*real(theta3) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta2 - conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + cos(conj(theta2) - 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*cos(2*real(theta3) + conj(theta2)) + cos(2*real(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) + cos(2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) - cos(theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) - cos(theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2))), -(cos(theta3 + 2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^3 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)^3 + abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - 2*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) + abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2 + theta3 - conj(theta2)) - abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2 + theta3 - conj(theta3)) - cos(theta3 + conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L2) + 2*cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 + cos(conj(theta2) - theta3 + conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3) + cos(2*real(theta2) + 2*real(theta3) - conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(theta3 + 2*real(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2 - cos(theta2 + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) + cos(theta3 - conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L2) + cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*cos(2*real(theta3) + conj(theta2)) - cos(2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) + cos(theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 -(abs(L1)^2*abs(L2)^2*conj(L3)^3*cos(theta2) - cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L3)^3 - abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) + abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) + cos(theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 - cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 + cos(theta2 + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - 2*cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - cos(conj(theta2) - 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + 2*cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2)/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (abs(L1)^2*abs(L2)^2*conj(L3)^3*cos(theta2) - cos(2*real(theta2) - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L3)^3 - abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) + cos(theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 - cos(conj(theta2) - theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2 + cos(theta2 + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3) - cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - cos(conj(theta2) - 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L2)*conj(L3)^2 + cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*cos(2*real(theta2) + conj(theta3)) + cos(2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) - cos(theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2))),                                                                                                                                                                                                                                                                                                  -(abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3 + 2*real(theta2) - conj(theta2) - conj(theta3)) - 2*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2*cos(theta3) - abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2 + theta3 - conj(theta2)) - abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2 + theta3 - conj(theta3)) + 2*cos(2*real(theta3) - conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L3)^2 - cos(conj(theta2) - theta2 + conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2 + cos(theta3 + 2*real(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2 + cos(2*real(theta2) + 2*real(theta3) - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 - cos(theta2 + theta3)*abs(L1)^2*abs(L3)^2*conj(L2)*conj(L3)^2 + abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*cos(2*real(theta2) + conj(theta3)) + cos(2*real(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3) + cos(2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) - cos(theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3) - cos(theta2 - conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta2)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)^2*cos(theta3)*sin(theta2) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta2)*sin(theta3) + sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L2)^2*conj(L3)*cos(theta3)*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L3)^2*sin(theta2) + cos(conj(theta2))*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + cos(conj(theta3))*sin(conj(theta2))*abs(L2)^2*abs(L3)^2*conj(L1)^2*conj(L3)*sin(theta3) + sin(conj(theta2))*abs(L1)^2*abs(L2)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*conj(L1)*conj(L2)*conj(L3)*cos(theta3)*sin(theta2)))];
     