function dldq = dldq(L1,L2,L3,theta1,theta2,theta3)

%dldq = 2.*dfdqT*Qdot;


dldq(1,1) = 0;
dldq(2,1) = -(sin(2*real(theta2))*abs(L1)^2*abs(L2)^2 + 2*sin(2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 + (L2*abs(L1)^2*abs(L3)^2*sin(2*real(theta3) + conj(theta2)))/(2*L1) + (L2*abs(L1)^2*abs(L3)^2*sin(2*real(theta2) + conj(theta3)))/L3 - (L1*abs(L2)^2*abs(L3)^2*sin(theta2 + theta3 - conj(theta3)))/(2*L2) - (L2*sin(conj(theta2) - theta3 + conj(theta3))*abs(L1)^2*abs(L3)^2)/(2*L1) + (L1*sin(theta2 + 2*real(theta3))*abs(L2)^2*abs(L3)^2)/(2*L2) + (L3*sin(theta3 + 2*real(theta2))*abs(L1)^2*abs(L2)^2)/L2)/(2*(sin(conj(theta2))*abs(L1)^2*abs(L2)^2*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*cos(theta3)*sin(theta2) + (L3*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*cos(theta2)*sin(theta3))/L2 + (L3*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*cos(theta3)*sin(theta2))/L2 + (L1*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*cos(theta2)*sin(theta3))/L2 + (L1*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*cos(theta3)*sin(theta2))/L2 + (L2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*sin(theta3))/L1 + (L2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*sin(theta3))/L1 + (L2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*sin(theta2))/L3 + (L2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*sin(theta2))/L3)^(3/2));
dldq(3,1) = -(2*sin(2*real(theta3))*abs(L2)^2*abs(L3)^2 + 2*sin(2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 + (L2*abs(L1)^2*abs(L3)^2*sin(2*real(theta3) + conj(theta2)))/L1 + (L2*abs(L1)^2*abs(L3)^2*sin(2*real(theta2) + conj(theta3)))/(2*L3) - (L3*abs(L1)^2*abs(L2)^2*sin(theta2 + theta3 - conj(theta2)))/(2*L2) - (L2*sin(conj(theta2) - theta2 + conj(theta3))*abs(L1)^2*abs(L3)^2)/(2*L3) + (L1*sin(theta2 + 2*real(theta3))*abs(L2)^2*abs(L3)^2)/L2 + (L3*sin(theta3 + 2*real(theta2))*abs(L1)^2*abs(L2)^2)/(2*L2))/(2*(sin(conj(theta2))*abs(L1)^2*abs(L2)^2*sin(theta2) + 2*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*cos(theta2)*sin(theta3) + 2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*cos(theta3)*sin(theta2) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*cos(theta2)*sin(theta3) + 2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*cos(theta3)*sin(theta2) + (L3*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*cos(theta2)*sin(theta3))/L2 + (L3*sin(conj(theta2))*abs(L1)^2*abs(L2)^2*cos(theta3)*sin(theta2))/L2 + (L1*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*cos(theta2)*sin(theta3))/L2 + (L1*sin(conj(theta3))*abs(L2)^2*abs(L3)^2*cos(theta3)*sin(theta2))/L2 + (L2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*sin(theta3))/L1 + (L2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*sin(theta3))/L1 + (L2*cos(conj(theta2))*sin(conj(theta3))*abs(L1)^2*abs(L3)^2*sin(theta2))/L3 + (L2*cos(conj(theta3))*sin(conj(theta2))*abs(L1)^2*abs(L3)^2*sin(theta2))/L3)^(3/2));
 
 